FROM quay.io/toolbx/arch-toolbox

LABEL com.github.containers.toolbox="true" \
      usage="This image is meant to be used with the toolbox or distrobox command" \
      summary="TidalCycles distrobox for Atelier Damillora" \
      maintainer="developer@damillora.com"

# Copy the setup scripts and package list
COPY ../scripts/distrobox-shims.sh /

RUN sudo pacman -Syu --noconfirm && sudo pacman -S --noconfirm pipewire-jack supercollider sc3-plugins ghc ghc-libs haskell-{tidal,bifunctors,colour,hosc,mwc-random,network,primitive,random,vector,microspec}

# Run the setup scripts
RUN chmod +x distrobox-shims.sh && /distrobox-shims.sh
RUN rm /distrobox-shims.sh
